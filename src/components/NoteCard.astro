---
import { Icon } from "astro-icon/components";

interface Props {
	name: string;
	slug: string;
	description: string;
	noteCount: number;
	image?: string;
	tags?: string[];
	noteTitles?: string;
	index?: number;
}

const {
	name,
	slug,
	description,
	noteCount,
	image,
	tags = [],
	noteTitles = "",
	index = 0,
} = Astro.props;
---

<a 
	href={`/notes/${slug}`}
	class="note-card card-base group hover:scale-105 transition-all duration-300 overflow-hidden onload-animation"
	style={index !== undefined ? `animation-delay: calc(var(--content-delay) + ${index * 50}ms)` : ''}
	data-note-titles={noteTitles}
>
	<!-- 课程封面 -->
	{image && (
		<div class="aspect-video overflow-hidden">
			<img 
				src={image} 
				alt={name}
				class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
			/>
		</div>
	)}
	
	<!-- 课程信息 -->
	<div class="p-6">
		<h2 class="text-2xl font-bold mb-2 text-black/90 dark:text-white/90 group-hover:text-[oklch(0.7_0.14_var(--hue))] transition-colors">
			{name}
		</h2>
		
		<p class="text-neutral-600 dark:text-neutral-400 text-sm mb-4 line-clamp-2">
			{description}
		</p>
		
		<!-- 统计信息 -->
		<div class="flex items-center gap-4 text-sm text-neutral-500 dark:text-neutral-400 mb-4">
			<div class="flex items-center gap-1">
				<Icon name="material-symbols:notes" class="text-base" />
				<span>{noteCount} 篇</span>
			</div>
			{tags.length > 0 && (
				<div class="flex items-center gap-1">
					<Icon name="material-symbols:label-outline" class="text-base" />
					<span>{tags.length} 个标签</span>
				</div>
			)}
		</div>
		
		<!-- 标签预览 -->
		{tags.length > 0 && (
			<div class="flex flex-wrap gap-2">
				{tags.slice(0, 3).map(tag => (
					<span class="text-xs px-2 py-1 rounded-full bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400">
						{tag}
					</span>
				))}
				{tags.length > 3 && (
					<span class="text-xs px-2 py-1 rounded-full bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400">
						+{tags.length - 3}
					</span>
				)}
			</div>
		)}
	</div>
	
	<!-- 查看箭头 -->
	<div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
		<Icon 
			name="material-symbols:arrow-forward" 
			class="text-2xl text-[oklch(0.7_0.14_var(--hue))]"
		/>
	</div>
</a>

<style>
	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
	
	.card-base {
		position: relative;
	}
</style>
